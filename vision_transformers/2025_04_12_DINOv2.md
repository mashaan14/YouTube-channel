# Inside the DINOv2 Architecture

<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
</head>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://www.youtube.com/embed/G6c6zk0RhRM" frameborder="0" allowfullscreen></iframe>
</div>


## Table of Contents

* [Acknowledgment](#acknowledgment)
* [References](#references)
* [global_crops and local_crops](#global_crops-and-local_crops)
* [Masking out global_crops patches](#masking-out-global_crops-patches)
* [ViT backbone](#ViT-backbone)
* [dino head](#dino-head)
* [ibot head](#ibot-head)
* [dino loss](#dino-loss)
* [ibot loss](#ibot-loss)
* [weights update](#weights-update)
* [putting it all together](#putting-it-all-together)


## Acknowledgment:
I borrowed some code from these resources:
  - [https://github.com/tkipf/pygcn/tree/master](https://github.com/tkipf/pygcn/tree/master)
  - [https://lightning.ai/docs/pytorch/stable/notebooks/course_UvA-DL/06-graph-neural-networks.html](https://lightning.ai/docs/pytorch/stable/notebooks/course_UvA-DL/06-graph-neural-networks.html)

## References:
```bibtex
@misc{kipf2017semisupervised,
    title         = {Semi-Supervised Classification with Graph Convolutional Networks},
    author        = {Thomas N. Kipf and Max Welling},
    year          = {2017},
    eprint        = {1609.02907},
    archivePrefix = {arXiv},
    primaryClass  = {cs.LG}
}
```

## `global_crops` and `local_crops`

![DINOv2-001](https://github.com/user-attachments/assets/79115429-4e89-4732-af37-271049240b1d)

---

![DINOv2-002](https://github.com/user-attachments/assets/dca63dcb-948c-47b6-8d7c-3e564aaf31d3)

## Masking out `global_crops` patches

![DINOv2-003](https://github.com/user-attachments/assets/16016557-d686-4533-b23a-d9ebe1bc1535)

---

## ViT backbone

![DINOv2-004](https://github.com/user-attachments/assets/7a8a502f-87d8-4046-a053-7102fbff162e)

---

![DINOv2-005](https://github.com/user-attachments/assets/023a4021-895b-4a35-81c3-e9301d76a801)

## dino head

![DINOv2-006](https://github.com/user-attachments/assets/2bbde612-7516-42d4-9368-9a4a042426ea)

## ibot head

![DINOv2-008](https://github.com/user-attachments/assets/c93a4ca6-466f-4511-8c42-cc43bdbcbce2)

## dino loss

![DINOv2-007](https://github.com/user-attachments/assets/34c96238-a203-4471-8ac1-85734ea0073b)

## ibot loss

![DINOv2-009](https://github.com/user-attachments/assets/8901a118-6aff-4171-96a7-3c529b12d4d6)

## weights update

The student network is updated with standard SGD, while the teacher network uses an exponential moving average (EMA) according to the following update rule:

![Untitled001](https://github.com/user-attachments/assets/252ced6d-aa2c-49a5-af91-61aca4b8db5c)

## putting it all together

![DINOv2-010](https://github.com/user-attachments/assets/e4a1dc6f-62e3-447c-a210-bc553a1055bf)




<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true}, // Display math (e.g., equations on their own line)
        {left: '$', right: '$', display: false},  // Inline math (e.g., within a sentence)
        {left: '\\(', right: '\\)', display: false}, // Another way to write inline math
        {left: '\\[', right: '\\]', display: true}   // Another way to write display math
      ]
    });
  });
</script>
